import{j as h}from"./chunk-O7C6FD42.js";import{a as r,b as o,db as l,eb as f,hb as w,l as n,oa as c,q as d,ra as m,ua as p,za as a}from"./chunk-G5QQY2EO.js";var v=new m("window local storage object",{providedIn:"root",factory:()=>a(p)==="browser"?window.localStorage:{}}),u=(()=>{let e=class e{constructor(){this.storage=a(v)}loadWatchlist(){let t=this.storage.getItem("watchlist");return d(t?JSON.parse(t):[])}saveWatchlist(t){this.storage.setItem("watchlist",JSON.stringify(t))}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=c({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var W=(()=>{let e=class e{constructor(){this.storageService=a(u),this.state=f({watchlistItems:[],loaded:!1,error:null}),this.watchlistItemsLoaded$=this.storageService.loadWatchlist(),this.watchlistItems=l(()=>this.state().watchlistItems),this.loaded=l(()=>this.state().loaded),this.add$=new n,this.remove$=new n,this.add$.pipe(h()).subscribe(t=>this.state.update(s=>o(r({},s),{watchlistItems:[...s.watchlistItems,t]}))),this.remove$.pipe(h()).subscribe(t=>this.state.update(s=>o(r({},s),{watchlistItems:s.watchlistItems.filter(I=>I.id!==t)}))),this.watchlistItemsLoaded$.pipe(h()).subscribe({next:t=>this.state.update(s=>o(r({},s),{watchlistItems:t,loaded:!0})),error:t=>this.state.update(s=>o(r({},s),{error:t}))}),w(()=>{this.loaded()&&this.storageService.saveWatchlist(this.watchlistItems())})}isMovieOnWatchlist(t){return this.watchlistItems().some(s=>s.id===t)}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=c({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();export{u as a,W as b};
