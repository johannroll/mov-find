import{k as h}from"./chunk-DM6JDEZS.js";import{a as r,b as o,db as l,eb as f,hb as w,l as n,oa as c,q as d,ra as m,ua as p,za as a}from"./chunk-S7LRKC3Z.js";var g=new m("window local storage object",{providedIn:"root",factory:()=>a(p)==="browser"?window.localStorage:{}}),u=(()=>{let t=class t{constructor(){this.storage=a(g)}loadWatchlist(){let e=this.storage.getItem("watchlist");return d(e?JSON.parse(e):[])}saveWatchlist(e){this.storage.setItem("watchlist",JSON.stringify(e))}};t.\u0275fac=function(s){return new(s||t)},t.\u0275prov=c({token:t,factory:t.\u0275fac,providedIn:"root"});let i=t;return i})();var A=(()=>{let t=class t{constructor(){this.storageService=a(u),this.state=f({watchlistItems:[],loaded:!1,error:null}),this.watchlistItemsLoaded$=this.storageService.loadWatchlist(),this.watchlistItems=l(()=>this.state().watchlistItems),this.loaded=l(()=>this.state().loaded),this.add$=new n,this.remove$=new n,this.add$.pipe(h()).subscribe(e=>this.state.update(s=>o(r({},s),{watchlistItems:[...s.watchlistItems,e]}))),this.remove$.pipe(h()).subscribe(e=>this.state.update(s=>o(r({},s),{watchlistItems:s.watchlistItems.filter(I=>I.id!==e)}))),this.watchlistItemsLoaded$.pipe(h()).subscribe({next:e=>this.state.update(s=>o(r({},s),{watchlistItems:e,loaded:!0})),error:e=>this.state.update(s=>o(r({},s),{error:e}))}),w(()=>{this.loaded()&&this.storageService.saveWatchlist(this.watchlistItems())})}};t.\u0275fac=function(s){return new(s||t)},t.\u0275prov=c({token:t,factory:t.\u0275fac,providedIn:"root"});let i=t;return i})();export{A as a};
